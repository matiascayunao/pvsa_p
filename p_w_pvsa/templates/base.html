<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>PVSA</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
          crossorigin="anonymous">

    <!-- Estilos mínimos propios -->
    <style>
      body { background-color: #f5f7fa; }
      .navbar-pvsa { background: #06b6b9; }
      .navbar-pvsa .nav-link,
      .navbar-pvsa .navbar-brand { color: #ffffff !important; }
      .navbar-pvsa .dropdown-menu { font-size: .9rem; }
      main { min-height: calc(100vh - 56px); }
      footer { font-size: .8rem; }
    </style>
  </head>

  <body>

    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg navbar-dark navbar-pvsa shadow-sm">
      <div class="container-fluid px-3">

        <!-- Marca (izquierda) -->
        <a class="navbar-brand fw-bold" href="{% url 'home' %}">PVSA</a>

        {% if user.is_authenticated %}
          <!-- Botón hamburguesa -->
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarPVSA"
                  aria-controls="navbarPVSA" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>

          <!-- Contenido colapsable -->
          <div class="collapse navbar-collapse" id="navbarPVSA">
            <!-- Wrapper para centrar el bloque del medio sin romper izquierda/derecha -->
            <div class="d-flex flex-column flex-lg-row w-100 align-items-lg-center">

              <!-- MENÚ CENTRAL (centrado real en LG y sin salto de línea) -->
              <div class="flex-grow-1 d-flex justify-content-lg-center">
                <div class="w-100 w-lg-auto overflow-auto">
                  <ul class="navbar-nav align-items-lg-center justify-content-lg-center flex-lg-nowrap gap-1 gap-lg-2 py-2 py-lg-0">

                    <li class="nav-item">
                      <a class="nav-link fw-semibold" href="{% url 'crear_estructura' %}">FORMULARIO</a>
                    </li>

                    <!-- RESUMEN al lado de FORMULARIO -->
                    <li class="nav-item">
                      <a class="nav-link fw-semibold" href="{% url 'resumen_general' %}">RESUMEN</a>
                    </li>

                    <li class="nav-item d-none d-lg-block">
                      <span class="vr mx-1"></span>
                    </li>

                    <!-- SECTOR -->
                    <li class="nav-item dropdown">
                      <a class="nav-link dropdown-toggle fw-semibold" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        SECTOR
                      </a>
                      <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="{% url 'lista_sectores' %}">Ver</a></li>
                        <li><a class="dropdown-item" href="{% url 'crear_sector' %}">Crear</a></li>
                      </ul>
                    </li>

                    <!-- UBICACION -->
                    <li class="nav-item dropdown">
                      <a class="nav-link dropdown-toggle fw-semibold" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        UBICACION
                      </a>
                      <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="{% url 'lista_ubicaciones' %}">Ver</a></li>
                        <li><a class="dropdown-item" href="{% url 'crear_ubicacion' %}">Crear</a></li>
                      </ul>
                    </li>

                    <!-- LUGAR -->
                    <li class="nav-item dropdown">
                      <a class="nav-link dropdown-toggle fw-semibold" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        LUGAR
                      </a>
                      <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="{% url 'lista_lugares' %}">Ver</a></li>
                        <li><a class="dropdown-item" href="{% url 'crear_lugar' %}">Crear</a></li>
                      </ul>
                    </li>

                    <li class="nav-item d-none d-lg-block">
                      <span class="vr mx-1"></span>
                    </li>

                    <!-- TIPO DE OBJETO -->
                    <li class="nav-item dropdown">
                      <a class="nav-link dropdown-toggle fw-semibold" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        TIPO DE OBJETO
                      </a>
                      <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="{% url 'lista_tipos_objeto' %}">Ver</a></li>
                        <li><a class="dropdown-item" href="{% url 'crear_tipo_objeto' %}">Crear</a></li>
                      </ul>
                    </li>

                    <!-- OBJETO DEL LUGAR -->
                    <li class="nav-item dropdown">
                      <a class="nav-link dropdown-toggle fw-semibold" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        OBJETO DEL LUGAR
                      </a>
                      <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="{% url 'lista_objetos_lugar' %}">Ver</a></li>
                      </ul>
                    </li>

                    <!-- HISTORICO -->
                    <li class="nav-item dropdown">
                      <a class="nav-link dropdown-toggle fw-semibold" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        HISTORICO
                      </a>
                      <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="{% url 'lista_historicos' %}">Ver</a></li>
                      </ul>
                    </li>

                  </ul>
                </div>
              </div>

              <!-- Usuario (derecha) -->
              <ul class="navbar-nav ms-lg-auto pb-2 pb-lg-0">
                <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle fw-semibold" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                    {{ user.username }}
                  </a>

                  <ul class="dropdown-menu dropdown-menu-end shadow-sm">
                    <li><h6 class="dropdown-header">Piso</h6></li>
                    <li><a class="dropdown-item" href="{% url 'lista_pisos' %}">Ver</a></li>
                    <li><a class="dropdown-item" href="{% url 'crear_piso' %}">Crear</a></li>

                    <li><hr class="dropdown-divider"></li>

                    <li><h6 class="dropdown-header">Tipo de lugar</h6></li>
                    <li><a class="dropdown-item" href="{% url 'lista_tipos_lugar' %}">Ver</a></li>
                    <li><a class="dropdown-item" href="{% url 'crear_tipo_lugar' %}">Crear</a></li>

                    <li><hr class="dropdown-divider"></li>

                    <li><h6 class="dropdown-header">Categoria del objeto</h6></li>
                    <li><a class="dropdown-item" href="{% url 'lista_categorias' %}">Ver</a></li>
                    <li><a class="dropdown-item" href="{% url 'crear_categoria_objeto' %}">Crear</a></li>

                    <li><hr class="dropdown-divider"></li>

                    <li><h6 class="dropdown-header">Objeto</h6></li>
                    <li><a class="dropdown-item" href="{% url 'lista_objetos' %}">Ver</a></li>
                    <li><a class="dropdown-item" href="{% url 'crear_objeto' %}">Crear</a></li>

                    {% if user.is_staff or user.is_superuser %}
                      <li><hr class="dropdown-divider"></li>
                      <li><a class="dropdown-item" href="{% url 'descargar_excel_sectores' %}">Descargar Excel</a></li>
                      <li><a class="dropdown-item" href="/admin/">Panel Admin</a></li>
                      <li><a class="dropdown-item" href="{% url 'signup' %}">Crear usuario</a></li>
                    {% endif %}

                    <li><hr class="dropdown-divider"></li>
                    <li><a class="dropdown-item" href="{% url 'signout' %}">Cerrar sesión</a></li>
                  </ul>

                </li>
              </ul>

            </div>
          </div>
        {% endif %}
      </div>
    </nav>

    <!-- CONTENIDO PRINCIPAL -->
    <main class="py-4">
      <div class="container">

        <!-- Mensajes de Django -->
        {% if messages %}
          <div class="mb-3">
            {% for message in messages %}
              <div class="alert alert-{{ message.tags|default:'info' }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
              </div>
            {% endfor %}
          </div>
        {% endif %}

        {% block content %}{% endblock %}
      </div>
    </main>

    <!-- FOOTER sencillo -->
    <footer class="border-top bg-white py-2">
      <div class="container d-flex justify-content-between">
        <span class="text-muted">PVSA · Sistema de registro de activos</span>
        <span class="text-muted">v1.0</span>
      </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
            crossorigin="anonymous"></script>
  </body>
</html>
